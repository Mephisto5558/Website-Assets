let MAX_FULL_RETRIES=100;function generateSudoku(o=9,t=o**2-20,r=1){var n=Math.sqrt(o);if(!Number.isInteger(n))throw new Error("Size must be quadratic.");globalThis.boardSize=o,console.debug(`Generating initial full Sudoku. Try ${r}/`+MAX_FULL_RETRIES);var a=Array.from({length:o},()=>Array.from({length:o}));if(fill(a,n),!countSolutions(structuredClone(a),n))return console.error("An invalid Sudoku has been generated."+(r<MAX_FULL_RETRIES?` Retrying ${r+1}/`+MAX_FULL_RETRIES:" Max retry reached. Not retrying.")),globalThis.debug?(console.error(JSON.stringify(a)),a):r<MAX_FULL_RETRIES?generateSudoku(o,t,r+1):(console.error(JSON.stringify(a)),Array.from({length:o},()=>Array.from({length:o},()=>0)));var i=o**2*5;console.debug("Starting to dig holes. Max Attempts: "+i);for(let r=0,e=0;r<t&&e<i;e++){console.debug(`Digging. Holes: ${r}/${t}, Attempts: ${e}/`+i);var u,l=rando(0,o-1),d=rando(0,o-1);a[l][d]&&((u=structuredClone(a))[l][d]=void 0,1<countSolutions(u,n)?console.debug("Sudoku has more than one possible solution. Next attempt."):(a[l][d]=void 0,r++))}return a}function fill(r,e,o=0,t=0){if(o==boardSize)return!0;for(var n of randoSequence(1,boardSize))if(!isUnsafe(r,e,o,t,n)){r[o][t]=n;var[n,a]=t+1==boardSize?[o+1,0]:[o,t+1];if(fill(r,e,n,a))return!0;r[o][t]=void 0}return!1}function countSolutions(e,o,t=0,n=0){if(t===boardSize)return 1;var[a,i]=n+1===boardSize?[t+1,0]:[t,n+1];if(!e[t][n])return countSolutions(e,o,a,i);let u=0;for(let r=1;r<=boardSize;r++)if(!isUnsafe(e,o,t,n,r)){e[t][n]=r;var l=countSolutions(e,o,a,i);if(e[t][n]=void 0,1<(u+=l))break}return u}function isUnsafe(o,t,e,n,a){for(let r=0;r<boardSize;r++)if(o[r][n]===a)return!0;for(let r=0;r<boardSize;r++)if(o[e][r]===a)return!0;var i=Math.floor(e/t)*t,u=Math.floor(n/t)*t;for(let e=0;e<t;e++)for(let r=0;r<t;r++)if(o[i+e][u+r]===a)return!0;return!1}function displayBoard(r){for(var e of htmlBoard.flat())e.value=r[Number(e.dataset.row)-1][Number(e.dataset.col)-1],void 0!==r[Number(e.dataset.row)-1][Number(e.dataset.col)-1]&&(e.disabled=!0)}export{generateSudoku,displayBoard};