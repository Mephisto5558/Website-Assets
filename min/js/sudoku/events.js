"use strict";(()=>{globalThis.debug=!1;globalThis.debugBoard=globalThis.debug;globalThis.runBench=!1;var w=9,k=.2,x=.75;var p=1e3,y=60;var s=[],m=document.querySelector("#sudoku"),f=document.querySelector("#difficulty-slider + output"),N=document.querySelector("#loading-container"),P=[...N.parentElement.children].filter(e=>e!=N),b=[...document.querySelectorAll("#number-overview > tbody > tr > td > span")],_=document.querySelector("#solution-btn"),B=document.querySelector("#regenerate-btn"),R=document.querySelector("#share-btn"),d=document.querySelector("#difficulty-slider"),c=document.querySelector("#size-option"),K=document.querySelector("#bg-color-switch"),U=document.querySelector("#fg-color-switch"),S=document.querySelector("#timer"),T=document.querySelector("#cancel-loading");var E=document.querySelector("#popup-container > h3"),L=document.querySelector("#popup-container > p");function v(){let e=performance.now();globalThis.timerInterval=setInterval(()=>{let r=(performance.now()-e)/p,t=Math.floor(r/y).toString().padStart(2,"0"),o=Math.round(r%y).toString().padStart(2,"0");S.textContent=`${t}:${o}`,S.setAttribute("datetime",`PT${t}M${o}S`)},p)}function g(e,r=!0){let t=b[e-1];if(t.textContent=Number(t.textContent)+(r?1:-1),t.textContent==b.length){t.classList.add("complete");for(let o of document.querySelectorAll("#sudoku td > .notes > span"))o.textContent==e&&(o.textContent="",o.classList.remove("visible"))}else t.classList.remove("complete");b.some(o=>!o.classList.contains("complete"))||(globalThis.timerInterval=clearInterval(globalThis.timerInterval))}function C(e){let r=new Set,t=n=>{let a=new Map;for(let i of n){let u=Number(i.value);u&&(a.has(u)||a.set(u,[]),a.get(u).push(i))}if([...a.values()].some(i=>i.length>1))for(let i of n)r.add(`${i.dataset.row}-${i.dataset.col}`)};for(let n=0;n<e.length;n++)t(e[n]),t(e.map(a=>a[n]));let o=Math.sqrt(e.length);for(let n=0;n<o;n++)for(let a=0;a<o;a++){let i=[];for(let u=0;u<o;u++)for(let h=0;h<o;h++)i.push(e[n*o+u][a*o+h]);t(i)}for(let n of e.flat())n.parentElement.classList[r.has(`${n.dataset.row}-${n.dataset.col}`)?"add":"remove"]("error")}function I(){let e=Number(c.value)**2||w;c.value=Math.sqrt(e);let r=Math.floor(e**2*k),t=Math.ceil(e**2*x);d.min=r,d.max=t;let o=Number(d.value)||rando(r,t);return d.value=o,f.textContent=o,{size:e,minHoles:r,maxHoles:t,holes:o}}function M(e,r=e){e!==r&&(E.textContent=e),L.textContent=r,E.parentElement.classList.add("visible"),setTimeout(()=>E.parentElement.classList.remove("visible"),p*3)}var X=void 0;function A(e,r){let t=Number(e.value+r);t>s.length&&(t=Number(r)),e.value&&g(Number(e.value),!1),e.value=t,g(t,!0),C(s)}function q(e,r){let t;if(e.tagName=="SPAN"?t=e:e.tagName=="INPUT"&&(t=[...e.parentElement.querySelector(".notes").children].find(a=>!a.textContent||a.textContent===r)),!t)return M("Notes full",`Your notes in row ${e.parentElement.firstChild.dataset.row}, column ${e.parentElement.firstChild.dataset.row} are full!
You can edit one by clicking on it.`);let o=Number(t.textContent+r);o>s.length&&(o=Number(r)),t.textContent=o,t.classList.add("visible")}function D(e){e.textContent="",e.classList.remove("visible")}function O(e){g(Number(e.value),!1),e.value="",C(s)}m.addEventListener("keypress",e=>{e.preventDefault();let r=m.classList.contains("notes-mode");if(e.key===" "){if(r&&e.target.matches(".notes > span"))return D(e.target);if(!r&&e.target.matches("input")&&e.target.value)return O(e.target)}if(/^[1-9]\d*$/.test(e.key)){if(globalThis.timerInterval||v(),r)return q(e.target,e.key);if(e.target.matches("input"))return A(e.target,e.key)}});var l=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End","Backspace"];m.addEventListener("keydown",e=>{if(l.includes(e.key)&&e.target.tagName!="INPUT"&&e.preventDefault(),e.key==="Enter"&&e.target.tagName=="SPAN")return e.target.blur();if(e.target.tagName!="INPUT"||!l.includes(e.key))return;if(e.key==l[7])return O(e.target);e.preventDefault();let r=s.length-1,t;if(e.key==l[5]||e.key==l[6]){let o=e.key==l[5]?"find":"findLast",n=a=>!a.disabled&&(!e.shiftKey||a.dataset.group==e.target.dataset.group);t=(e.ctrlKey?s[o](a=>a.some(n)):s[Number(e.target.dataset.row)-1])[o](n)}for(;(!t||t.disabled)&&!(t&&t.dataset.row==e.target.dataset.row&&t.dataset.col==e.target.dataset.col);){let o=Number((t??e.target).dataset.row)-1,n=Number((t??e.target).dataset.col)-1;switch(e.key){case l[0]:t=s[o==0?r:o-1][n];break;case l[1]:t=s[o==r?0:o+1][n];break;case l[2]:t=s[o][n==0?r:n-1];break;case l[3]:t=s[o][n==r?0:n+1];break;case l[4]:if(e.shiftKey){o==0&&n==0?t=s[r][r]:n==0?t=s[o-1][r]:t=s[o][n-1];break}o==r&&n==r?t=s[0][0]:n==r?t=s[o+1][0]:t=s[o][n+1];break}}t.focus()});m.addEventListener("blur",e=>{if(e.target.tagName=="SPAN"&&!e.target.textContent)return e.target.classList.remove("visible")},!0);document.querySelector("#stepper-up").addEventListener("click",()=>{c.stepUp(),c.dispatchEvent(new Event("change",{bubbles:!0}))});document.querySelector("#stepper-down").addEventListener("click",()=>{c.stepDown(),c.dispatchEvent(new Event("change",{bubbles:!0}))});c.addEventListener("change",I);d.addEventListener("input",e=>f.textContent=e.target.value);T.addEventListener("click",()=>{globalThis.sudokuWorker.terminate(),globalThis.sudokuWorker.dispatchEvent(new MessageEvent("message",{data:{type:"cancel",message:"user request"}})),delete globalThis.sudokuWorker});document.querySelector("#toggle-notes-btn").addEventListener("click",e=>{e.target.textContent=`${m.classList.toggle("notes-mode")?"Disable":"Enable"} Notes Mode`});})();
//# sourceMappingURL=events.js.map
