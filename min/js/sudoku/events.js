"use strict";(()=>{globalThis.debug=!1;globalThis.debugBoard=globalThis.debug;globalThis.runBench=!1;var C=9,M=.2,w=.75;var m=1e3,E=60;var a=[],d=document.querySelector("#sudoku"),p=document.querySelector("#difficulty-slider + output"),y=document.querySelector("#loading-container"),D=[...y.parentElement.children].filter(e=>e!=y),x=document.querySelector("#number-overview"),f=[...x.querySelectorAll("tbody > tr > td > span")],P=document.querySelector("#solution-btn"),B=document.querySelector("#regenerate-btn"),_=document.querySelector("#share-btn"),c=document.querySelector("#difficulty-slider"),s=document.querySelector("#size-option"),R=document.querySelector("#bg-color-switch"),K=document.querySelector("#fg-color-switch"),h=document.querySelector("#timer"),L=document.querySelector("#cancel-loading");var T=document.querySelector("#popup-container > h3"),k=document.querySelector("#popup-container > p");function v(){let e=performance.now();globalThis.timerInterval=setInterval(()=>{let r=(performance.now()-e)/m,o=Math.floor(r/E).toString().padStart(2,"0"),t=Math.round(r%E).toString().padStart(2,"0");h.textContent=`${o}:${t}`,h.setAttribute("datetime",`PT${o}M${t}S`)},m)}function b(e,r=!1){let o=f[e-1];if(o.textContent=(Number(o.textContent)+(r?1:-1)).toString(),Number(o.textContent)==f.length){o.classList.add("complete");for(let t of document.querySelectorAll("#sudoku td > .notes > span"))Number(t.textContent)==e&&(t.textContent="",t.classList.remove("visible"))}else o.classList.remove("complete");f.some(t=>!t.classList.contains("complete"))||(clearInterval(globalThis.timerInterval),globalThis.timerInterval=void 0)}function S(e){let r=new Set,o=n=>{let l=new Map;for(let i of n){let u=Number(i.value);u&&(l.has(u)||l.set(u,[]),l.get(u).push(i))}if([...l.values()].some(i=>i.length>1))for(let i of n)r.add(`${i.dataset.row}-${i.dataset.col}`)};for(let n=0;n<e.length;n++)o(e[n]),o(e.map(l=>l[n]));let t=Math.sqrt(e.length);for(let n=0;n<t;n++)for(let l=0;l<t;l++){let i=[];for(let u=0;u<t;u++)for(let g=0;g<t;g++)i.push(e[n*t+u][l*t+g]);o(i)}for(let n of e.flat())n.parentElement.classList.toggle("error",r.has(`${n.dataset.row}-${n.dataset.col}`))}function I(){let e=Number(s.value)**2||C;s.value=Math.sqrt(e).toString();let r=Math.floor(e**2*M),o=Math.ceil(e**2*w);c.min=r.toString(),c.max=o.toString();let t=Number(c.value)||rando(r,o);return c.value=t.toString(),p.textContent=t.toString(),{size:e,minHoles:r,maxHoles:o,holes:t}}function N(e,r=""){e!==r&&(T.textContent=e),k.textContent=r,T.parentElement.classList.add("visible"),setTimeout(()=>T.parentElement.classList.remove("visible"),m*3)}var Y=void 0;function H(e,r){let o=Number(e.value+r);o>a.length&&(o=Number(r)),e.value&&b(Number(e.value),!1),e.value=o.toString(),b(o,!0),S(a)}function A(e,r){let o;if(e instanceof HTMLSpanElement?o=e:e instanceof HTMLInputElement&&(o=[...e.parentElement.querySelector(".notes").children].find(n=>!n.textContent||n.textContent===r)),!o)return N("Notes full",`Your notes in row ${e.parentElement.firstChild.dataset.row}, column ${e.parentElement.firstChild.dataset.row} are full!
You can edit one by clicking on it.`);let t=Number(o.textContent+r);t>a.length&&(t=Number(r)),o.textContent=t.toString(),o.classList.add("visible")}function O(e){e.textContent="",e.classList.remove("visible")}function q(e){b(Number(e.value),!1),e.value="",S(a)}d.addEventListener("keypress",e=>{let r=d.classList.contains("notes-mode");if(e.key===" "){if(e.preventDefault(),r&&e.target instanceof HTMLSpanElement)return O(e.target);if(!r&&e.target instanceof HTMLInputElement&&e.target.value)return q(e.target)}if(/^[1-9]\d*$/.test(e.key))e.preventDefault();else return;if(globalThis.timerInterval||v(),r&&e.target instanceof HTMLSpanElement)return A(e.target,e.key);if(e.target instanceof HTMLInputElement)return H(e.target,e.key)});d.addEventListener("keydown",e=>{if(e.target instanceof HTMLSpanElement&&e.key==="Enter")return e.target.blur();if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End"].includes(e.key))return;e.target instanceof HTMLInputElement||e.preventDefault();let r=a.length-1,o=n=>!n.disabled&&(!e.shiftKey||n.dataset.group==e.target.dataset.group),t;for(e.key=="Home"?t=(e.ctrlKey?a.find(n=>n.some(o)):a[Number(e.target.dataset.row)-1]).find(o):e.key=="End"&&(t=(e.ctrlKey?a.findLast(n=>n.some(o)):a[Number(e.target.dataset.row)-1]).findLast(o));(!t||t.disabled)&&!(t&&t.dataset.row==e.target.dataset.row&&t.dataset.col==e.target.dataset.col);){let n=Number((t??e.target).dataset.row)-1,l=Number((t??e.target).dataset.col)-1;switch(e.key){case"ArrowUp":t=a[n==0?r:n-1][l];break;case"ArrowDown":t=a[n==r?0:n+1][l];break;case"ArrowLeft":t=a[n][l==0?r:l-1];break;case"ArrowRight":t=a[n][l==r?0:l+1];break;case"Tab":if(e.shiftKey){n==0&&l==0?t=a[r][r]:l==0?t=a[n-1][r]:t=a[n][l-1];break}n==r&&l==r?t=a[0][0]:l==r?t=a[n+1][0]:t=a[n][l+1];break;default:break}}t.focus()});d.addEventListener("blur",e=>{if(e.target instanceof HTMLSpanElement&&!e.target.textContent)return e.target.classList.remove("visible")},!0);document.querySelector("#stepper-up").addEventListener("click",()=>{s.stepUp(),s.dispatchEvent(new Event("change",{bubbles:!0}))});document.querySelector("#stepper-down").addEventListener("click",()=>{s.stepDown(),s.dispatchEvent(new Event("change",{bubbles:!0}))});s.addEventListener("change",I);c.addEventListener("input",e=>p.textContent=e.target.value);L.addEventListener("click",()=>{globalThis.sudokuWorker?.terminate(),globalThis.sudokuWorker?.dispatchEvent(new MessageEvent("message",{data:{type:"cancel",message:"user request"}})),globalThis.sudokuWorker=void 0});document.querySelector("#toggle-notes-btn").addEventListener("click",e=>{e.target.textContent=`${d.classList.toggle("notes-mode")?"Disable":"Enable"} Notes Mode`});})();
//# sourceMappingURL=events.js.map
