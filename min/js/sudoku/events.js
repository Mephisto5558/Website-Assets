"use strict";(()=>{globalThis.debug=!1;globalThis.debugBoard=globalThis.debug;globalThis.runBench=!1;var C=9,L=.2,N=.75;var p=1e3,h=60;var a=[],m=document.querySelector("#sudoku"),f=document.querySelector("#difficulty-slider + output"),M=document.querySelector("#loading-container"),D=[...M.parentElement.children].filter(e=>e!=M),g=[...document.querySelectorAll("#number-overview > tbody > tr > td > span")],B=document.querySelector("#solution-btn"),P=document.querySelector("#regenerate-btn"),_=document.querySelector("#share-btn"),d=document.querySelector("#difficulty-slider"),u=document.querySelector("#size-option"),R=document.querySelector("#bg-color-switch"),K=document.querySelector("#fg-color-switch"),S=document.querySelector("#timer"),v=document.querySelector("#cancel-loading");var T=document.querySelector("#popup-container > h3"),H=document.querySelector("#popup-container > p");function I(){let e=performance.now();globalThis.timerInterval=setInterval(()=>{let o=(performance.now()-e)/p,t=Math.floor(o/h).toString().padStart(2,"0"),n=Math.round(o%h).toString().padStart(2,"0");S.textContent=`${t}:${n}`,S.setAttribute("datetime",`PT${t}M${n}S`)},p)}function b(e,o=!1){let t=g[e-1];if(t.textContent=(Number(t.textContent)+(o?1:-1)).toString(),Number(t.textContent)==g.length){t.classList.add("complete");for(let n of document.querySelectorAll("#sudoku td > .notes > span"))Number(n.textContent)==e&&(n.textContent="",n.classList.remove("visible"))}else t.classList.remove("complete");g.some(n=>!n.classList.contains("complete"))||(clearInterval(globalThis.timerInterval),globalThis.timerInterval=void 0)}function y(e){let o=new Set,t=r=>{let l=new Map;for(let s of r){let c=Number(s.value);c&&(l.has(c)||l.set(c,[]),l.get(c).push(s))}if([...l.values()].some(s=>s.length>1))for(let s of r)o.add(`${s.dataset.row}-${s.dataset.col}`)};for(let r=0;r<e.length;r++)t(e[r]),t(e.map(l=>l[r]));let n=Math.sqrt(e.length);for(let r=0;r<n;r++)for(let l=0;l<n;l++){let s=[];for(let c=0;c<n;c++)for(let E=0;E<n;E++)s.push(e[r*n+c][l*n+E]);t(s)}for(let r of e.flat())r.parentElement.classList.toggle("error",o.has(`${r.dataset.row}-${r.dataset.col}`))}function w(){let e=Number(u.value)**2||C;u.value=Math.sqrt(e).toString();let o=Math.floor(e**2*L),t=Math.ceil(e**2*N);d.min=o.toString(),d.max=t.toString();let n=Number(d.value)||rando(o,t);return d.value=n.toString(),f.textContent=n.toString(),{size:e,minHoles:o,maxHoles:t,holes:n}}function x(e,o=""){e!==o&&(T.textContent=e),H.textContent=o,T.parentElement.classList.add("visible"),setTimeout(()=>T.parentElement.classList.remove("visible"),p*3)}var X=void 0;function O(e,o){let t=Number(e.value+o);t>a.length&&(t=Number(o)),e.value&&b(Number(e.value),!1),e.value=t.toString(),b(t,!0),y(a)}function q(e,o){let t;if(e instanceof HTMLSpanElement?t=e:e instanceof HTMLInputElement&&(t=[...e.parentElement.querySelector(".notes").children].find(l=>!l.textContent||l.textContent===o)),!t)return x("Notes full",`Your notes in row ${e.parentElement.firstChild.dataset.row}, column ${e.parentElement.firstChild.dataset.row} are full!
You can edit one by clicking on it.`);let n=Number(t.textContent+o);n>a.length&&(n=Number(o)),t.textContent=n.toString(),t.classList.add("visible")}function A(e){e.textContent="",e.classList.remove("visible")}function k(e){b(Number(e.value),!1),e.value="",y(a)}m.addEventListener("keypress",e=>{e.preventDefault();let o=m.classList.contains("notes-mode");if(e.key===" "){if(o&&e.target.matches(".notes > span"))return A(e.target);if(!o&&e.target.matches("input")&&e.target.value)return k(e.target)}if(/^[1-9]\d*$/.test(e.key)){if(globalThis.timerInterval||I(),o)return q(e.target,e.key);if(e.target.matches("input"))return O(e.target,e.key)}});var i=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End","Backspace"];m.addEventListener("keydown",e=>{if(i.includes(e.key)&&e.target.tagName!="INPUT"&&e.preventDefault(),e.key==="Enter"&&e.target.tagName=="SPAN")return e.target.blur();if(e.target.tagName!="INPUT"||!i.includes(e.key))return;if(e.key==i[7])return k(e.target);e.preventDefault();let o=a.length-1,t;if(e.key==i[5]||e.key==i[6]){let n=e.key==i[5]?"find":"findLast",r=l=>!l.disabled&&(!e.shiftKey||l.dataset.group==e.target.dataset.group);t=(e.ctrlKey?a[n](l=>l.some(r)):a[Number(e.target.dataset.row)-1])[n](r)}for(;(!t||t.disabled)&&!(t&&t.dataset.row==e.target.dataset.row&&t.dataset.col==e.target.dataset.col);){let n=Number((t??e.target).dataset.row)-1,r=Number((t??e.target).dataset.col)-1;switch(e.key){case i[0]:t=a[n==0?o:n-1][r];break;case i[1]:t=a[n==o?0:n+1][r];break;case i[2]:t=a[n][r==0?o:r-1];break;case i[3]:t=a[n][r==o?0:r+1];break;case i[4]:if(e.shiftKey){n==0&&r==0?t=a[o][o]:r==0?t=a[n-1][o]:t=a[n][r-1];break}n==o&&r==o?t=a[0][0]:r==o?t=a[n+1][0]:t=a[n][r+1];break}}t.focus()});m.addEventListener("blur",e=>{if(e.target instanceof HTMLSpanElement&&!e.target.textContent)return e.target.classList.remove("visible")},!0);document.querySelector("#stepper-up").addEventListener("click",()=>{u.stepUp(),u.dispatchEvent(new Event("change",{bubbles:!0}))});document.querySelector("#stepper-down").addEventListener("click",()=>{u.stepDown(),u.dispatchEvent(new Event("change",{bubbles:!0}))});u.addEventListener("change",w);d.addEventListener("input",e=>f.textContent=e.target.value);v.addEventListener("click",()=>{globalThis.sudokuWorker?.terminate(),globalThis.sudokuWorker?.dispatchEvent(new MessageEvent("message",{data:{type:"cancel",message:"user request"}})),delete globalThis.sudokuWorker});document.querySelector("#toggle-notes-btn").addEventListener("click",e=>{e.target.textContent=`${m.classList.toggle("notes-mode")?"Disable":"Enable"} Notes Mode`});})();
//# sourceMappingURL=events.js.map
