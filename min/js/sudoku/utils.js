import{DEFAULT_BOARD_SIZE,difficultyOutput,difficultySlider,MAX_HOLES_PERCENTAGE,MIN_HOLES_PERCENTAGE,MS_IN_SEC,numberOverviewSpans,SEC_IN_MIN,sizeOption,timer}from"./constants.js";let popupTileElement=document.querySelector("#popup-container > h3"),popupPElement=document.querySelector("#popup-container > p");function setRootStyle(e,t,r){return document.documentElement.style.setProperty(e,t,r)}function getRootStyle(e){return globalThis.getComputedStyle(document.documentElement).getPropertyValue(e)}function invertHex(e){return"#"+(3==(e=e.replace("#","")).length?[...e]:e.match(/\w{2}/g)).map(e=>(255-Number.parseInt(e,16)).toString(16).padStart(2,"0")).join("")}async function saveToClipboard(e){if(globalThis.navigator.clipboard)return await globalThis.navigator.clipboard.writeText(e),sendPopup("Saved the link in your clipboard.");var t=document.createElement("textarea");t.value=e,t.classList.add("hidden"),document.body.append(t),t.focus({preventScroll:!0}),t.select();try{if(!document.execCommand("copy"))throw new Error("Did not save");sendPopup("Saved the link in your clipboard.")}catch(e){console.error("Could not copy to clipboard using document.execCommand:",e),sendPopup("Error","Cold not copy the URL to your clipboard. Please copy it manually from the address bar.")}t.remove()}function initializeColorPicker(e,t,r){var o=localStorage.getItem(t);e.value=o??getRootStyle(e.dataset.cssProperty).trim(),o&&r(o),e.addEventListener("change",e=>{e=e.target.value;localStorage.setItem(t,e),r(e)})}function getGroupId(e,t,r){return Math.floor(e/r)*r+Math.floor(t/r)}function startTimer(){let r=performance.now();globalThis.timerInterval=setInterval(()=>{var e=(performance.now()-r)/MS_IN_SEC,t=Math.floor(e/SEC_IN_MIN).toString().padStart(2,"0"),e=Math.round(e%SEC_IN_MIN).toString().padStart(2,"0");timer.textContent=t+":"+e,timer.setAttribute("datetime",`PT${t}M${e}S`)},MS_IN_SEC)}function clearTimer(){globalThis.timerInterval=clearInterval(globalThis.timerInterval),timer.textContent="00:00",timer.setAttribute("datetime","PT0S")}function updateNumberOverviewSpan(e,t=!0){var r=numberOverviewSpans[e-1];if(r.textContent=Number(r.textContent)+(t?1:-1),r.textContent==numberOverviewSpans.length){r.classList.add("complete");for(var o of document.querySelectorAll("#sudoku td > .notes > span"))o.textContent==e&&(o.textContent="",o.classList.remove("visible"))}else r.classList.remove("complete");numberOverviewSpans.some(e=>!e.classList.contains("complete"))||(globalThis.timerInterval=clearInterval(globalThis.timerInterval))}function checkErrors(n){let a=new Set;var e=e=>{var t,r=new Map;for(t of e){var o=Number(t.value);o&&(r.has(o)||r.set(o,[]),r.get(o).push(t))}if([...r.values()].some(e=>1<e.length))for(var n of e)a.add(n.dataset.row+"-"+n.dataset.col)};for(let t=0;t<n.length;t++)e(n[t]),e(n.map(e=>e[t]));var t,l=Math.sqrt(n.length);for(let o=0;o<l;o++)for(let r=0;r<l;r++){var i=[];for(let t=0;t<l;t++)for(let e=0;e<l;e++)i.push(n[o*l+t][r*l+e]);e(i)}for(t of n.flat())t.parentElement.classList[a.has(t.dataset.row+"-"+t.dataset.col)?"add":"remove"]("error")}function updateMinMax(){var e=Number(sizeOption.value)**2||DEFAULT_BOARD_SIZE,t=(sizeOption.value=Math.sqrt(e),Math.floor(e**2*MIN_HOLES_PERCENTAGE)),r=Math.ceil(e**2*MAX_HOLES_PERCENTAGE),o=(difficultySlider.min=t,difficultySlider.max=r,Number(difficultySlider.value)||rando(t,r));return difficultySlider.value=o,{size:e,minHoles:t,maxHoles:r,holes:difficultyOutput.textContent=o}}function sendPopup(e,t=e){e!==t&&(popupTileElement.textContent=e),popupPElement.textContent=t,popupTileElement.parentElement.classList.add("visible"),setTimeout(()=>popupTileElement.parentElement.classList.remove("visible"),3*MS_IN_SEC)}export{setRootStyle,getRootStyle,invertHex,saveToClipboard,initializeColorPicker,getGroupId,startTimer,clearTimer,updateNumberOverviewSpan,checkErrors,updateMinMax,sendPopup};